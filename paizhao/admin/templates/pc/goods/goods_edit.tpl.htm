<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>修改商品</title>
    <meta http-equiv="Content-Type" content="text/html; charset=GBK">
    <script type="text/javascript" src="./js/jquery.min.js"></script>
    <script type="text/javascript" src="http://www.yueus.com/js/selectlocal.js"></script>
    <script language="javascript" type="text/javascript" src="js/DatePicker/WdatePicker.js"></script>
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <link type="text/css" href="css/jquery-ui-1.8.17.custom.css" rel="stylesheet" />
    <link type="text/css" href="css/jquery-ui-timepicker-addon.css" rel="stylesheet" />
    <script type="text/javascript" src="js/jquery-ui-1.8.17.custom.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-timepicker-addon.js"></script>
    <script type="text/javascript" src="js/jquery-ui-timepicker-zh-CN.js"></script>
    <script type="text/javascript" src="http://www.yueus.com/js/selectlocal.js"></script>
    
    <script src="js/shadowbox/shadowbox.js" type="text/javascript"></script>
    <link href="js/shadowbox/shadowbox.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript">
        $(function () {
            $(".ui_timepicker").datetimepicker({
            });
            $(".ui_timepicker_time").datetimepicker({
                //showOn: "button",
                //buttonImage: "./css/images/icon_calendar.gif",
                //buttonImageOnly: true,
                showSecond: true,
                timeFormat: 'hh:mm',
                stepHour: 1,
                stepMinute: 1,
                stepSecond: 1
            });
        })
    </script>

</head>
<body>
<div id="top"></div>
<a href="#bottom" class="btn_class" style="position:fixed;top:0;right:10px;">↓</a>
<style>
    .J_add_btn,.J_add_cover_img{
        overflow: hidden;
    }
    .model-img-list li{
        float:left; width:85px; height:100px; text-align:center; margin-right:10px
    }
    #img_wid img{
        width:200px
    }
    /**添加样式，避免被重写样式**/
    fieldset{
        width:100%
    }
    .J_location_sel{
        display: inline;

    }
    .J_location_sel_2{
        display: inline;

    }
    .J_location_sel_3{
        display: inline;

    }
    
</style>
<script>
    Shadowbox.init({
        handleOversize: "drag",
        overlayColor: '#000',
        modal: true,
        displayNav: true,
        displayCounter: false
    });
    Shadowbox.setup();
    function change_status(id,status)
    {
        if(!confirm('是否确认修改状态？'))
        {
            return;
        }
        $.ajax( {
            url:'?action=goods_chstatus&id='+id+'&status='+status,
            type:'post',
            cache:false,
            dataType:'json',
            success:function(data) {
                alert(data.message);
                /*
                 if(data.result==1){
                 alert('修改成功');
                 location.reload();
                 }else{
                 alert(data.message);
                 }
                 */
            },
            error : function() {
                alert("异常！");
            }
        });
    }
</script>
<div class="mainbox">
<div id="tabs" style="margin-top:10px;">
<div class="tabbox">
<div class="table-list">
<div class="table" style="width:100%;">
<fieldset>
<legend>修改商品</legend>
<iframe id="form_iframe" name="form_iframe" style="display:none;"></iframe>
<form id="form1" name="form1" method="post" action="" target="form_iframe" onsubmit="return check();">
<table width="90%" align="center">
<!-- BEGIN default_data -->
<tr>
    <td width="26%" height="25">{name}
    <!-- IF name = "价格" -->
    <!-- IF top.show_prices = "1" -->
    (价格ID:0)
    <!-- ENDIF -->
    <!-- ENDIF -->
    </td>
    <td width="74%" height="25">
        <!-- IF input="3" -->
            <!-- IF key="tags" -->
                <span>大分类:</span>
                <select class="big_type" onChange="get_second(this)">
                    <option>请选择</option>
                </select>
                <span>小分类:</span>
                <select class="small_type">
                    <option>请选择</option>
                </select><span class="plus_span" onClick="add_tags_to_tr()">+</span>
                &nbsp;&nbsp;
                <span class="tags_ary">
                        <!-- BEGIN tags_ary -->
                            <span class="{id}">{text}<input type="hidden" name="tags_ary[]" value="{value}"/><span class="x_span" onclick="del_text_tags(this)">X</span>&nbsp;&nbsp;</span>
                       <!-- END tags_ary -->
                </span>
                <br/>
<!--                <span class="parent_tags_arr">
                已选的大分类:
                         BEGIN parent_tags_arr 
                            <span>{text}</span>&nbsp;
                        END parent_tags_arr 
                </span>-->
                <script>
                        $(function(){
                            var get_son_list_json = {top.get_son_list_json};
                            $(".big_type").empty();
                            $(".big_type").append("<option value=''>请选择</option>");
                            $.each(get_son_list_json,function(i,item){
                                $(".big_type").append("<option id='"+item.id+"' value='"+item.id+"'>"+item.name+"</option>");

                            });
                        });
                        function get_second(obj)
                        {
                            var big_type_id = $(obj).val();
                            var get_son_list_json = {top.get_son_list_json};
                            $.each(get_son_list_json,function(i,item){
                                if(item.id == big_type_id)
                                {
                                    $(".small_type").empty();
                                    $(".small_type").append("<option value=''>请选择</option>");
                                    $.each(item.son_list,function(i_s,item_s){
                                      $(".small_type").append("<option id='"+item_s.id+"' value='"+item_s.id+"'>"+item_s.name+"</option>");
                                    });
                                }
                                
                            });
                        }
                        function add_tags_to_tr()
                        {
                            var big_type_id = $(".big_type").val();
                            var small_type_id = $(".small_type").val();
                            if(big_type_id == '')
                            {
                                alert('大分类不能为空');
                                return false;
                            }
//                            if(small_type_id == '')
//                            {
//                                alert("小分类不能为空");
//                                return false;
//                            }
                            var big_type_name = $("#"+big_type_id).text();
                            var small_type_name = $("#"+small_type_id).text();
                            if( $(".tags_ary span").hasClass(big_type_id+'_'+small_type_id) )
                            {
                                alert('标签类型已经有，请不要重复添加');
                                return false;
                            }
                            $(".tags_ary").append("<span class='"+big_type_id+'_'+small_type_id+"'>"+big_type_name+'-'+small_type_name+"<input type='hidden' name='tags_ary[]' value='"+big_type_id+','+small_type_id+"'/><span class='x_span' onClick='del_text_tags(this)'>X</span>&nbsp;&nbsp;</span>");
                        }
                        
                        function del_text_tags(obj)
                        {
                            $(obj).parent().remove();
                        }
                </script>
            <!-- ENDIF -->
            <!-- IF key="profession_id" -->
                {profession_name}
            <!-- ENDIF -->
            <input name="default_data[{key}]" <!-- IF key="tags" --> style="display:none;" <!-- ENDIF -->  <!-- IF key="profession_id" --> type="hidden" <!-- ELSE --> type="text" <!-- ENDIF -->  id="default_data[{key}]" value="{value}" size="50" maxlength="50" />
        <!-- ELSEIF input="5" -->
        <div>在线编辑器:</div>
        <script id="js_editor" class="edui_editor_wrp" name="default_data[{key}]" type="text/plain">{value}</script>
        <script type="text/javascript">
        $(function(){
            var editor = YUE_EDITOR.init_editor("js_editor",
            {
              wordCount: false,
              elementPathEnabled: false,
              pasteplain:true,
              toolbars: [
                    [
                        "fullscreen",// 全屏
                        "source",// 源代码
                        "|",
                        "undo",// 撤销
                        "redo",// 重做
                        "bold",// 加粗
                        "italic",// 斜体
                        "underline",// 下划线
                        "blockquote",// 引用
                        "|","removeformat",// 清除格式
                        "fontsize", // 字体
                        "forecolor",// 字体颜色
                        "backcolor",// 字体背景色
                        "|",
                        "link",// 超链接
                        "unlink",// 清除超链接
                        "justifyleft",// 居左
                        "justifycenter",// 居中
                        "justifyright",// 居右
                        "indent",// 首行缩进
                        "|","insertimage2",// 自定义传图
                        "insertvideo2"// 自定义视频
                    ]
                ],
            });
            editor.ready(function()
            {
              // 编辑器初始化
            });
        });

      </script>
        

        <!-- ELSEIF input="8" -->

        <!-- 活动地区代码 -->
        <input type="radio" name="locate_value_checked" value="0" class="J_locate_select" data-mark="0" <!-- IF value == "0" -->checked="checked"<!-- ENDIF value --> tabindex="1"/>全国
        <input type="radio" name="locate_value_checked" value="1" class="J_locate_select" data-mark="1" <!-- IF value != "0" -->checked="checked"<!-- ENDIF value --> tabindex="1"/>地区选择
        <span id="J_locate_select_container" style="display:<!-- IF value == "0" -->none;<!-- ELSE -->inline-block;<!-- ENDIF value -->">

        <!--地区组件-->
<!--                <script src="http://static-c1.yueus.com/yue_ui/mod/1.0.0/mod.js"></script>-->
                {top.widget_location_2}
                <script>
                    //切换回调处理
                    $(function()
                    {
                        var input_name_id = "{top.input_name_id_2}";
                        window.__yue_location_widget__[input_name_id].$el.on('change_province_callback',function(ev,data)
                        {
                            console.log(data);
                        });

                        window.__yue_location_widget__[input_name_id].$el.on('change_city_callback',function(ev,data)
                        {
                            console.log(data);
                        });

                        window.__yue_location_widget__[input_name_id].$el.on('change_district_callback',function(ev,data)
                        {
                            console.log(data);
                        });
                    });
                </script>
        <!--地区组件end-->
        <input type="hidden" value="101029001" id="default_location_id" name="default_data[{key}]"/>
        </span>
        
        <style>
            .plus_span,.x_span {  
                cursor: pointer;
                border: 2px solid rgb(75, 171, 54);
                display: inline-block;
                height: 20px;
                line-height: 20px;
                border-radius: 10px;
                width: 20px;
                text-align: center;
            }
            .x_span { border:2px solid rgb(184, 52, 82)}
            .plus_span {margin_right:10px;}
        </style>
        <input type="hidden" value="{value}" data-role="{top.goods.goods_data.province_value}" id="location_id"/>
        
        <span class="location_id_s">
                   <span class="plus_span" onclick="get_location_id_to_text();">+</span>&nbsp;&nbsp;
                    <span class="location_id_ary">
                         <!-- IF value!="0" -->   
                            <!-- BEGIN location_ary_new -->
                            <span class="text_{id}">{text}<input type="hidden" name="location_id_ary[]" value="{id}"/><span class="x_span" onclick="del_text_location_id({id})">X</span>&nbsp;&nbsp;</span>
                            <!-- END location_ary_new -->
                         <!-- ENDIF -->
                    </span>
        </span>
              
        <script>
            function get_location_id_to_text()
            {
                var location_id = $('[data-role="select-location-location_id_2"] select[data-role="s-province"]').val();
               
                if(location_id == '' || location_id == undefined)
                {
                    location_id = $('[data-role="select-location-location_id_2"] select[data-role="s-city"]').val();
                    if(location_id == '' || location_id == undefined)
                    {
                        alert('请选择地区');
                        return false;
                    }

                }else
                {
                    var city_location_id = $('[data-role="select-location-location_id_2"] select[data-role="s-city"]').val();
                    
                    if(city_location_id)
                    {
                        location_id = city_location_id;
                    }
                }
                if( ! confirm('确定添加?'))
                {
                   return false;
                }
                var location_text = $("option[value="+location_id+"]").eq(0).text();
                if($(".location_id_ary span").hasClass("text_"+location_id))
                {
                    alert('地区已经有，请不要重复添加');
                    return false;
                }
                $(".location_id_ary").append("<span class='text_"+location_id+"'>"+location_text+" <span class='x_span' onclick='del_text_location_id("+location_id+")'>X</span><input type='hidden' name='location_id_ary[]' value='"+location_id+"'/>&nbsp;&nbsp;</span>");
                
            }
            
            function del_text_location_id(id)
            {
                if( ! confirm('确定删除?'))
                {
                   return false;
                }
                if( ! id )
                {
                    return false;
                }
                $(".text_"+id).remove();
            }
            
        </script>



        <!--<input name="default_data[{key}]" type="hidden" id="default_data[{key}]" value="{value}" />-->
        <!--{data}-->
        <!-- ELSEIF input="1" -->
        <!-- BEGIN child_data -->
        <input class="parent_input_service" data-role="{val}" type="radio" name="default_data[{parent.key}]" id="default_data[{parent.key}]" value="{val}" <!-- IF parent.key="service_id" --><!-- IF top.audit_pass -->disabled<!-- ENDIF --><!-- ENDIF --> <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}<br>
        <!-- IF goods_service_detail -->
        <!-- BEGIN goods_service_detail -->
        <!-- BEGIN data -->

        <!-- IF key != "location_id" -->
        <div class="child_input_service"  data-role="child_input_{parent.parent.val}" <!-- IF parent.parent.is_select != "1" -->style="display:none"<!-- ENDIF parent.parent.is_select -->>&nbsp;&nbsp;&nbsp;&nbsp;{name}:<input <!-- IF key == "ac_time" -->class="ui_timepicker"<!-- ENDIF key --> name="service_detail[{parent.parent.val}][{parent.key}][{key}]" id="service_detail[{parent.parent.val}][{parent.key}][{key}]" value="{value}" /></div>
        <!-- ELSE -->
        
        <!--地区组件-->
<!--                <script src="http://static-c1.yueus.com/yue_ui/mod/1.0.0/mod.js"></script>-->
                {top.widget_location_3}
                <script>
                    //切换回调处理
                    $(function()
                    {
                        var input_name_id = "{top.input_name_id_3}";
                        window.__yue_location_widget__[input_name_id].$el.on('change_province_callback',function(ev,data)
                        {
                            console.log(data);
                        });

                        window.__yue_location_widget__[input_name_id].$el.on('change_city_callback',function(ev,data)
                        {
                            console.log(data);
                        });

                        window.__yue_location_widget__[input_name_id].$el.on('change_district_callback',function(ev,data)
                        {
                            console.log(data);
                        });
                    });
                </script>
        <!--地区组件end-->
        <input type="hidden" value="{value}" name="service_detail[{parent.parent.val}][{parent.key}][{key}]" id="default_location_id_3"/>
        <!-- ENDIF key -->


        <!-- END data -->
        <!-- END goods_service_detail -->
        <br>
        <!-- ENDIF -->
        <!-- END child_data -->
        
        <!-- ELSEIF input="2" -->
        <!-- BEGIN child_data -->
        <input name="default_data[{parent.key}]" type="checkbox" id="default_data[{parent.key}]" value="{val}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}&nbsp;&nbsp;
        <!-- END child_data -->
        <!-- ELSE -->
        <textarea name="default_data[{key}]" cols="50" rows="5" id="default_data[{key}]">{value}</textarea>
        <!-- ENDIF -->
    </td>
</tr>
<!-- END default_data -->
<!-- BEGIN system_data -->
<tr>
    <td width="26%" height="25">{name}</td>
    <td width="74%" height="25">
        <!-- IF input="3" -->
        <!-- IF id == "381" -->
        
            <!--地区组件-->
                    {top.widget_location}
                    <script>
                        //切换回调处理
                        $(function()
                        {
                            var input_name_id = "{top.input_name_id}";
                            window.__yue_location_widget__[input_name_id].$el.on('change_province_callback',function(ev,data)
                            {
                                console.log(data);
                            });

                            window.__yue_location_widget__[input_name_id].$el.on('change_city_callback',function(ev,data)
                            {
                                console.log(data);
                            });

                            window.__yue_location_widget__[input_name_id].$el.on('change_district_callback',function(ev,data)
                            {
                                console.log(data);
                            });
                        });
                    </script>
            <!--地区组件end-->
        <input type="hidden" value="{value}" id="default_location_id_2" name="system_data[{key}]"/>
        
        <!-- ELSE -->
        <input name="system_data[{key}]" type="text" id="system_data[{key}]" value="{value}" size="50" maxlength="50" />
        <!-- ENDIF id -->
        <!-- ELSEIF input="4" -->
        <textarea name="system_data[{key}]" cols="50" rows="5" id="system_data[{key}]">{value}</textarea>
        <!-- ELSEIF input="9" -->
        <input name="system_data[{key}]" type="hidden" id="system_data[{key}]" value="{value}" />
        <!-- BEGIN child_data -->
        {name}:
        <!-- IF input="3" -->
        <input name="system_data[{parent.key}][{key}]" type="text" id="system_data[{parent.key}][{key}]" value="{value}" size="50" maxlength="50" />
        <!-- ELSEIF input="4" -->
        <textarea name="system_data[{parent.key}][{key}]" cols="50" rows="5" id="system_data[{parent.key}][{key}]">{value}</textarea>
        <!-- ELSEIF input="1" -->
        <!-- BEGIN child_data -->
        <input type="radio" name="system_data[{parent.parent.key}][{parent.key}]" id="system_data[{parent.parent.key}][{parent.key}]" value="{name}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}&nbsp;&nbsp;
        <!-- END child_data -->
        <!-- ELSEIF input="2" -->
        <!-- BEGIN child_data -->
        <!-- END child_data -->
        <!-- ENDIF -->
        {mess}<br>
        <!-- END child_data -->
        <!-- ELSEIF input="6" -->
        <input id="system_data[{key}]" type="text" size="25" name="system_data[{key}]" readonly="readonly" value="{value}" class="ui_timepicker" />
        <!-- ELSEIF input="7" -->
        <input id="system_data[{key}]" type="text" size="25" name="system_data[{key}]" readonly="readonly" value="{value}" class="ui_timepicker_time" />
        <!-- ELSEIF input="1" -->
        <!--                         <select name="system_data[{key}]" id="system_data[{key}]">
                                     <!-- BEGIN child_data -->
        <option value="{key}" <!-- IF is_select -->selected="selected"<!-- ENDIF -->>{name}</option>
        <!-- END child_data -->
        </select>
        -->
        <!-- BEGIN child_data -->
        <input name="system_data[{parent.key}]" class="J_parent_type" data-mark="{id}" type="radio" id="system_data[{parent.key}]" value="{key}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}
        <!-- IF child_data -->
        &nbsp;&nbsp;&nbsp;&nbsp;[详情:
        <!-- IF input="2" -->
        <!-- BEGIN child_data -->
        <input name="system_data[{parent.key}][]" class="J_child_type" data-parent="{parent.id}" type="checkbox" id="system_data[{parent.key}][]" value="{key}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}&nbsp;&nbsp;
        <!-- END child_data -->
        <!-- ELSEIF input="1" -->
        <!-- BEGIN child_data -->
        <input type="radio" name="system_data[{parent.key}]" class="J_child_type" data-parent="{parent.id}" id="system_data[{parent.key}]" value="{key}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}&nbsp;&nbsp;
        <!-- END child_data -->
        <!-- ENDIF -->
        ]
        <!-- ENDIF -->
        <br>
        <!-- END child_data -->

        <!-- ELSEIF input="2" -->
        <!-- BEGIN child_data -->
        <input name="system_data[{parent.key}][]" class="J_parent_type" data-mark="{id}" type="checkbox" id="system_data[{parent.key}][]" value="{key}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}
        <!-- IF child_data -->
        &nbsp;&nbsp;&nbsp;&nbsp;[详情:
        <!-- IF input="2" -->
        <!-- BEGIN child_data -->
        <input name="system_data[{parent.key}][]" class="J_child_type" data-parent="{parent.id}" type="checkbox" id="system_data[{parent.key}][]" value="{key}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}&nbsp;&nbsp;
        <!-- END child_data -->
        <!-- ELSEIF input="1" -->
        <!-- BEGIN child_data -->
        <input type="radio" name="system_data[{parent.key}]" class="J_child_type" data-parent="{parent.id}" id="system_data[{parent.key}]" value="{key}" <!-- IF is_select -->checked="checked"<!-- ENDIF --> />{name}&nbsp;&nbsp;
        <!-- END child_data -->
        <!-- ENDIF -->
        ]
        <!-- ENDIF -->
<!--        <br><br>-->
        <!-- END child_data -->
        <!-- ENDIF -->
    </td>
</tr>
<!-- END system_data -->
<!-- BEGIN diy_data -->
<tr>
    <td width="26%" height="25">{name}</td>
    <td width="74%" height="25">
        <!-- IF input="3" -->
        <input name="diy_data[{key}]" type="text" id="diy_data[{key}]" value="{value}" size="50" maxlength="50" />
        <!-- ELSE -->
        <textarea name="diy_data[{key}]" cols="50" rows="5" id="diy_data[{key}]">{value}</textarea>
        <!-- ENDIF -->
    </td>
</tr>
<!-- END diy_data -->


<!-- BEGIN combination_data -->
<tr>
    <td width="26%" height="25">标题:</td>
    <td width="74%" height="25">
        <input name="combination_data[{name}][titles]" type="text" id="combination_data[{name}][titles]" value="{data.titles}" size="50" maxlength="50" />
    </td>
</tr>
<tr>
    <td width="26%" height="25">正文:</td>
    <td width="74%" height="25">
        <textarea name="combination_data[{name}][content]" cols="50" rows="5" id="combination_data[{name}][content]">{data.content}</textarea>
    </td>
</tr>
<tr>
    <td width="26%" height="25">图片:</td>
    <td width="74%" height="25">
        <!-- BEGIN data.images -->
        <input name="combination_data[{parent.name}][images][]" type="text" id="combination_data[{parent.name}][images][]" value="{src}" size="50" /><br>
        <!-- END data.images -->
    </td>
</tr>
<!-- END combination_data -->
<!-- BEGIN contact_data -->
<tr>
    <td width="26%" height="25">联系人:</td>
    <td width="74%" height="25">
        <input name="contact_data[{name}][name]" type="text" id="contact_data[{name}][name]" value="{data.name}" size="50" maxlength="50" />
    </td>
</tr>
<tr>
    <td width="26%" height="25">联系方式:</td>
    <td width="74%" height="25">
        <input name="contact_data[{name}][phone]" type="text" id="contact_data[{name}][phone]" value="{data.phone}" size="50" maxlength="50" />
    </td>
</tr>
<!-- END contact_data -->

<!-- BEGIN prices_data_list -->
<!-- IF top.stock_type="7" -->
<tr>
    <td width="26%" height="25">场次:(场次ID:{type_id})</td>
    <td width="74%" height="25">
        名称:
        <input id="prices_diy[{type_id}][name]" type="text" size="14" name="prices_diy[{type_id}][name]" value="{name}"/>
        <br />
        时间:
        <input id="prices_diy[{type_id}][time_s]" type="text" size="28" name="prices_diy[{type_id}][time_s]" value="{time_s}" class="ui_timepicker" readonly="readonly"/>
        至
        <input id="prices_diy[{type_id}][time_e]" type="text" size="28" name="prices_diy[{type_id}][time_e]" value="{time_e}" class="ui_timepicker" readonly="readonly"/>
        <br />
        名额:
        <input id="prices_diy[{type_id}][stock_num]" type="text" size="14" name="prices_diy[{type_id}][stock_num]" value="{stock_num_total}"/>&nbsp;&nbsp;已报名：{has_num}&nbsp;&nbsp;剩下：{stock_num}
        <br />
        最大购买量:
        <input id="prices_diy[{type_id}][buy_num]" type="text" size="14" name="prices_diy[{type_id}][buy_num]" value="{buy_num}"/>
        <br />
        <!-- BEGIN prices_list_data -->
        名称:<input id="prices_diy[{parent.type_id}][detail][name][{id}]" type="text" size="24" name="prices_diy[{parent.type_id}][detail][name][{id}]" value="{name}"/>&nbsp;&nbsp;
        价格:<input id="prices_diy[{parent.type_id}][detail][prices][{id}]" type="text" size="6" name="prices_diy[{parent.type_id}][detail][prices][{id}]" value="{prices}"/>(价格ID:{id})&nbsp;&nbsp;
        <br />
        <!-- END prices_list_data -->
    </td>
</tr>
<!-- ELSEIF top.stock_type="5" -->
<tr>
    <td width="26%" height="25">自定义价格(价格ID:{type_id}):</td>
    <td width="74%" height="25">
        名称:
        <input id="prices_diy[{type_id}][name]" type="text" size="14" name="prices_diy[{type_id}][name]" value="{name}"/>
        <br />
        规格说明:
        <textarea name="prices_diy[{type_id}][mess]" cols="50" rows="5" id="prices_diy[{type_id}][mess]">{mess}</textarea>
        <br />
        <!--
        时间:
        <input id="prices_diy[{type_id}][time_s]" type="text" size="24" name="prices_diy[{type_id}][time_s]" value="{time_s}" class="ui_timepicker" readonly="readonly"/>
        至
        <input id="prices_diy[{type_id}][time_e]" type="text" size="24" name="prices_diy[{type_id}][time_e]" value="{time_e}" class="ui_timepicker" readonly="readonly"/>
        <br />
        -->
        名额:
        <input id="prices_diy[{type_id}][stock_num]" type="text" size="14" name="prices_diy[{type_id}][stock_num]" value="{stock_num}"/>
        <br />
        最大购买量:
        <input id="prices_diy[{type_id}][buy_num]" type="text" size="14" name="prices_diy[{type_id}][buy_num]" value="{buy_num}"/>
        <br />
        价格:
        <input id="prices_diy[{type_id}][prices]" type="text" size="14" name="prices_diy[{type_id}][prices]" value="{prices}"/>
    </td>
</tr>
<!-- ELSE -->
<!-- IF prices_type="1" -->
<tr>
    <td width="26%" height="25">{goods_data.stock_type}[价格](价格ID:{key})</td>
    <td width="74%" height="25">{name}
        <input id="prices_de[{key}]" type="text" size="14" name="prices_de[{key}]" value="{value}"/>
        <!-- IF top.stock_type="4" -->
        <br />库存<input id="prices_de_detail[{key}][stock_num]" type="text" size="14" name="prices_de_detail[{key}][stock_num]" value="{stock_num}"/>
        <!-- ELSEIF top.stock_type="8" -->
        <br />库存<input id="prices_de_detail[{key}][stock_num]" type="text" size="14" name="prices_de_detail[{key}][stock_num]" value="{stock_num}"/>
        <!-- ENDIF -->
        <br />
        最大购买量:
        <input id="prices_de_detail[{key}][buy_num]" type="text" size="14" name="prices_de_detail[{key}][buy_num]" value="{buy_num}"/>
    </td>
</tr>
<!-- ELSEIF prices_type="2" -->
<tr>
    <td width="26%" height="25">自定义价格(价格ID:{type_id}):</td>
    <td width="74%" height="25">
        名称:
        <input id="prices_diy[{type_id}][name]" type="text" size="14" name="prices_diy[{type_id}][name]" value="{name}"/>
        <br />描述:
        <textarea name="prices_diy[{type_id}][mess]" cols="50" rows="5" id="prices_diy[{type_id}][mess]">{mess}</textarea>
        <br />库存:
        <input id="prices_diy[{type_id}][stock_num]" type="text" size="14" name="prices_diy[{type_id}][stock_num]" value="{stock_num}"/>
        <br />
        最大购买量:
        <input id="prices_diy[{type_id}][buy_num]" type="text" size="14" name="prices_diy[{type_id}][buy_num]" value="{buy_num}"/>
        <br />
        价格:
        <input id="prices_diy[{type_id}][prices]" type="text" size="14" name="prices_diy[{type_id}][prices]" value="{prices}"/>
    </td>
</tr>
<!-- ENDIF -->
<!-- ENDIF -->
<!-- END prices_data_list -->
<tr>
    <td width="26%" height="25">{image_data.name}</td>
    <td width="74%" height="25">
        <div class="from-con">
            <div class="img_upload_item">
                <div class="img-list clearfix">
                    <div class="J_upload-container_1 ui-item" style="overflow:hidden;">

                    </div>
                </div>
            </div>
        </div>
    </td>
</tr>
<tr>
    <!-- IF admin_ac -->
<tr>
    <td colspan="2" align="center">
        <input id="user_str" type="text" size="50" name="user_str" value=""/>
        <input type="button" name="button2" id="button2" value="拷贝" onclick="javascript:$('#form1').attr('action', '?action=goods_copy');$('#form1').submit();"/></td>
    </td>
</tr>
<!-- ENDIF -->
<td colspan="2" align="center">
    <input name="goods_id" type="hidden" id="goods_id" value="{id}" />
    <input name="action" type="hidden" value="goods_edit" />
    <input type="button" name="button" id="button"  class="btn_class" value="修改资料" style="margin-right:20px;cursor:pointer;" />

    <!-- IF goods.goods_data.status = "0" -->
    <a href="javascript:change_status({goods.goods_data.goods_id},1)" class="btn_class">通过</a>&nbsp;&nbsp;
    <a rel="shadowbox[goods_change_{goods.goods_data.goods_id}];height=350;width=420" href="?action=goods_chstatus&id={goods.goods_data.goods_id}&status=2&tpl=show" class="btn_class">不通过</a>&nbsp;&nbsp;
    <!--<a href="javascript:change_status({goods_id},3)">删除</a>&nbsp;&nbsp;-->
    <!-- ELSEIF goods.goods_data.status = "1" -->
    <a rel="shadowbox[goods_change_{goods.goods_data.goods_id}];height=350;width=420" href="?action=goods_chstatus&id={goods.goods_data.goods_id}&status=2&tpl=show" class="btn_class">不通过</a>&nbsp;&nbsp;
    <!--
    <a href="javascript:change_status({goods_id},3)">删除</a>&nbsp;&nbsp;
    -->
    <!-- ELSEIF goods.goods_data.status = "2" -->
    <a href="javascript:change_status({goods.goods_data.goods_id},1)" class="btn_class">通过</a>&nbsp;&nbsp;
    <!--
    <a href="javascript:change_status({goods_id},3)">删除</a>&nbsp;&nbsp;
    -->
    <!-- ENDIF -->
</td>
</tr>
</table>
</form>
<script>
    function check()
    {
        if(confirm('是否确认修改,如果有多价格,请注意展示价格.'))
        {
            return true;
        }
        return false;
    }
</script>
</fieldset>
</div>
</div>
</div>
</div>
</div>
<div class="mainbox">
    <div id="tabs2" style="margin-top:10px;">
        <div class="tabbox">
            <div class="table-list">
                <div class="table" style="width:100%;">
                    <fieldset>
                        <legend>操作记录</legend>
                        <form id="form2" name="form1" method="post" action="" target="_self">
                            <table width="90%" align="center">
                                <tr>
                                    <td width="26%" height="25" align="center" valign="middle">操作类型</td>
                                    <td width="18%" height="25" align="center" valign="middle">时间</td>
                                    <td width="19%" align="center" valign="middle">操作人</td>
                                    <td width="37%" align="center" valign="middle">备注</td>
                                </tr>
                                <!-- BEGIN log_list -->
                                <tr>
                                    <td width="26%" height="25" align="center" valign="middle">{type_name}</td>
                                    <td width="18%" height="25" align="center" valign="middle">{add_time}</td>
                                    <td width="19%" align="center" valign="middle">{user_name}</td>
                                    <td width="37%" align="center" valign="middle">{note}</td>
                                </tr>
                                <!-- END log_list -->
                                <tr>
                                    <td colspan="4" align="center">&nbsp;</td>
                                </tr>
                            </table>
                        </form>
                    </fieldset>
                </div>
            </div>
        </div>
    </div>
</div>

<input type="hidden" id="add_flash_num" value="1"/><!--要增加的falsh数值，页面有一个，则数值为二，同时也作为id标示-->


<script>

    $(function(){
        var len = $("#img_wid img").length;
        for(var i = 0; i < len;i++)
        {
            var src = $("#img_wid img").eq(i).attr("src");
            $("#img_wid img").eq(i).wrap("<a href='"+src+"' target='_blank' ></a>");
        }

        var len_small = $(".J_upload_img").length;
        for(var i = 0; i < len_small ; i++)
        {
            var src = $(".J_upload_img").eq(i).attr("big_src");
            $(".J_upload_img").eq(i).wrap("<a href='"+src+"' target='_blank' ></a>");

        }
    });

    
        $(document).ready(function(){
            
            //提交校验
            //封面图是否上传
            $("#button").click(function(){
                var res = form_check();
                //form_summit
                if(res)
                {
                    $("#form1").submit();
                }
            });
            function form_check()
            {
                return true;
            }


            /****2015-10-10-星星添加-分类初始化选择交互****/
            //初始化处理
            var J_parent_type_len = $(".J_parent_type").length;
            var cur_checked,cur_data_mark;
            for(var i=0;i<J_parent_type_len;i++)
            {
                cur_checked = $($(".J_parent_type")[i]).prop("checked");
                if(!cur_checked)
                {
                    cur_data_mark = $($(".J_parent_type")[i]).attr("data-mark");
                    //子分类不能勾选
                    $(".J_child_type[data-parent='"+cur_data_mark+"']").attr("disabled","disabled");

                }
            }
            //选择后处理
            $(".J_parent_type").on("change",function(){

                var J_parent_type_len = $(".J_parent_type").length;
                var cur_checked,cur_data_mark;
                for(var i=0;i<J_parent_type_len;i++)
                {
                    cur_checked = $($(".J_parent_type")[i]).prop("checked");
                    cur_data_mark = $($(".J_parent_type")[i]).attr("data-mark");
                    if(!cur_checked)
                    {
                        //子分类不能勾选
                        $(".J_child_type[data-parent='"+cur_data_mark+"']").attr("disabled","disabled");
                        $(".J_child_type[data-parent='"+cur_data_mark+"']").prop("checked",false);

                    }
                    else
                    {
                        $(".J_child_type[data-parent='"+cur_data_mark+"']").removeAttr("disabled");
                    }
                }

                /*var new_data_mark =  $(this).attr("data-mark");
                 $(".J_parent_type").prop("checked",false);
                 $(this).prop("checked",true);
                 $(".J_child_type").attr("disabled","disabled");
                 $(".J_child_type").prop("checked",false);
                 //选中的可选
                 $(".J_child_type[data-parent='"+new_data_mark+"']").removeAttr("disabled");*/


            });

            /****2015-10-10-星星添加-分类初始化选择交互****/
        });
        
</script>

</body>
<script style="text/javascript">
    //展示地区的切换
    $(".J_locate_select").on("change",function(e){
        var target = e.target;
        var data_mark = $(target).attr("data-mark");
        if(data_mark==0)
        {
            $("#J_locate_select_container").css("display","none");
            $(".location_id_s").hide();
        }
        else
        {
            $("#J_locate_select_container").css("display","inline-block");
            $(".location_id_s").show();
        }

    });
</script>
<a href="#top" class="btn_class" style="position:fixed;bottom:0;right:10px;">↑</a>
<div id="bottom"></div>
</html>

<!--文本编辑器JS-->
<script type="text/javascript" src="http://static.yueus.com/yue_ui/yuebjq/1.0.0/yuebjq.config.js"></script> 
<script type="text/javascript" src="http://static.yueus.com/yue_ui/yuebjq/1.0.0/yuebjq.all.js"></script>
<script type="text/javascript" src="http://static.yueus.com/yue_ui/yuebjq/1.0.0/custom.js"></script>
<!--文本编辑器JS-->


<!--传图必须使用-->
<!--<script type="text/javascript" src="http://static-c.yueus.com/yue_ui/js/jquery.js"></script>-->
<script type="text/javascript" src="http://static-c.yueus.com/yue_ui/upload/1.0.2/webuploader.min.js?f=111"></script>
<script type="text/javascript" src="http://static-c.yueus.com/yue_ui/upload/1.0.2/yueyue_uploader_v2.js?f=111"></script>
<!--<script type="text/javascript" src="http://static-c.yueus.com/yue_ui/upload/1.0.2/yueyue_uploader.js?f=111"></script>-->
<script type="text/javascript" src="http://static-c.yueus.com/yue_ui/layer/1.0.0/layer/layer.js?f=22222"></script>
<!--传图必须使用-->

<script>
$(function(){
   // 使用
    var json_img_data = {top.image_json_data};
    var img_str = [];
    if(json_img_data)
    {
        $.each(json_img_data, function (i, item) {  //关键是怎么each循环读出来
            img_str[i] = item.img_url;
        });
    }
    
    add_upload_com($('.J_upload-container_1'),
    {
        part_id : 'upload_imgs_0',// 图片组id，确保每组图片都有唯一id做标记
        imgs_arr : img_str,// 初始化图片
        user_id : '100002',
        limit : 20
    });
    
    
});
function add_upload_com($el,options)
{
		options = options || {};
		// ======== 传图组件开始 ========
		var part_id = options.part_id;
		var imgs_arr = options.imgs_arr;
		var user_id = options.user_id;
		var limit = options.limit; 	
		var yue_upload_obj = new yue_upload_class
			({
				upload_total_limit : limit,// 传图上限
				upload_container : $el,
				user_id :  user_id,// 用户id
				multiple : true,// 是否多图
				imgs : imgs_arr,
				sortable : false,
				fileSizeLimit: 3 * limit * 1024 * 1024,    // 9 M * 上限 总文件大小
				fileSingleSizeLimit: 3 * 1024 * 1024,    // 3 M 单文件大小
				gid : part_id,
				extensions : 'gif,jpg,jpeg,bmp,png'
			});

			$('['+yue_upload_obj.uuid+']').on('click', function()
			{
				var upload_obj = {};
				first_layer = layer.open
				({
					type: 1,
					area: ['800px', '470px'],
					fix: false, //不固定
					title:'上传图片',
					maxmin: false,
					content: yue_upload_obj.tpl,
					success : function($el,index)
					{
						var sec_layer = null;
						var index = index;
                        setTimeout(function()
						{
							upload_obj = yue_upload_obj.init_upload($el);

							upload_obj.on('uploadProgress',function()
							{

							})
							.on('fileQueued',function(file)
							{

							})
							.on('fileDequeued',function(file)
							{

							})
							.on('uploadSuccess',function(file,response)
							{
								// response 服务端返回数据
								//console.log(response);
							})
							.on('uploadError',function()
							{

							})
							.on('uploadFinished',function()
							{
								layer.close(index);
							})
						},500);
					},
					cancel : function()
					{
						if(!confirm('注意！关闭弹窗会终止上传图片'))
						{
							return false;
						}

						upload_obj && upload_obj.stop(true);

						layer.close();
					}
				});
			});
		// ======== 传图组件结束 ========
}
</script>


