define("wap-huipai:global/lazyload/lazyload",function(t,n,r){var e=t("wap-huipai:global/utility/index");!function(t,n){function a(t,n){var r=this;if(!t)throw"尚未初始化化lazyload的父容器";return n=n||{},r.init(t,n),r}function o(n,r){var e=(new Image,n.getAttribute("data-lazyload-url")),a=this;r=r||{},e&&u(e,{load:function(){var o=this;t(n).hasClass("error")&&t(n).removeClass("error refresh");var l=n.getAttribute("data-size")||r.size,c=o.width,u=o.height;if(l){var s=i(l,c,u);n.style.height=s+"px"}a._st=setTimeout(function(){"IMG"==n.tagName?n.src=e:n.style.backgroundImage="url("+e+")","IMG"==n.tagName&&n.hasAttribute("height")&&n.removeAttribute("height"),t(n).addClass("loaded").removeAttr("data-lazyload-url")},250),"function"==typeof r.callback&&r.callback.call(a,o)},error:function(){var r=this;console.warn("图片加载失败:src="+r.src),t(n).addClass("error"),t(n).one("click",function(t){t.stopPropagation(),t.preventDefault(),r.retry=1,o(r)}).addClass("refresh")}})}function i(t,n,r){var a=e.int(t),n=e.int(n),r=e.int(r),o=a*r/n;return o=e.int(o)}function l(r){var e=r.getBoundingClientRect();return r.getAttribute("data-top")||(r.setAttribute("data-top",e.top),t(r).addClass("img")),e.top>=0&&e.left>=0&&e.top<=(n.innerHeight||document.documentElement.clientHeight)}function c(t){return"function"==typeof t}function u(t,n){var r=new Image;return r.src=t,r.complete?void(c(n.load)&&n.load.call(r)):(r.onerror=function(){c(n.error)&&n.error.call(r),r=r.onload=r.onerror=null},void(r.onload=function(){c(n.load)&&n.load.call(r),r=r.onload=r.onerror=null}))}a.prototype={init:function(r,e){var a=this;a.options=e,a.size=a.options.size,a.distance=a.options.distance||0,a.currentELE={},r?(this.container=r,a.freshELE(this.container),a.engine(),t(n).scroll(function(){a.engine()})):this.container=null},freshELE:function(n){var r=this;n=n||r.container;var e=t(n).find("[data-lazyload-url]"),a=[];e.each(function(n,r){var e=t(r).attr("data-lazyload-url");a[n]={url:e,obj:r}}),r.currentELE=a},engine:function(){var t=this;if(t.currentELE.length)for(var n=0;n<t.currentELE.length;n++)l(t.currentELE[n].obj,t.container)&&o(t.currentELE[n].obj,{size:t.size,callback:function(r){r.src==t.currentELE[n]&&t.currentELE[n].url&&t.currentELE.splice(n,1)}})},refresh:function(){var t=this;t.freshELE(),t.engine()}},r.exports=a}($,window)});