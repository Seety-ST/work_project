(function(){function g(){this._listener=[]}g.prototype.bind=function(k,m){var l=this._listener[k]||[];l.push(m);this._listener[k]=l};g.prototype.trigger=function(k){var l=Array.prototype.slice.apply(arguments).slice(1);var m=this._listener[k];if(!Array.isArray(m)){return}m.forEach(function(o){try{o.apply(this,l)}catch(n){console.error(n)}})};function d(k){return(k||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")}function f(l,k){if(!l||!k){return false}if(k.indexOf(" ")!=-1){throw new Error("className should not contain space.")}if(l.classList){return l.classList.contains(k)}else{return(" "+l.className+" ").indexOf(" "+k+" ")>-1}}function b(o,k){if(!o){return}var q=o.className;var n=(k||"").split(" ");for(var m=0,l=n.length;m<l;m++){var p=n[m];if(!p){continue}if(o.classList){o.classList.add(p)}else{if(!f(o,p)){q+=" "+p}}}if(!o.classList){o.className=q}}function h(o,k){if(!o||!k){return}var n=k.split(" ");var q=" "+o.className+" ";for(var m=0,l=n.length;m<l;m++){var p=n[m];if(!p){continue}if(o.classList){o.classList.remove(p)}else{if(f(o,p)){q=q.replace(" "+p+" "," ")}}}if(!o.classList){o.className=d(q)}}var j=(function(){if(document.addEventListener){return function(k,m,l){if(k&&m&&l){k.addEventListener(m,l,false)}}}else{return function(k,m,l){if(k&&m&&l){k.attachEvent("on"+m,l)}}}})();var e=(function(){if(document.removeEventListener){return function(k,m,l){if(k&&m){k.removeEventListener(m,l,false)}}}else{return function(k,m,l){if(k&&m){k.detachEvent("on"+m,l)}}}})();var a=function(o,q,s){o=o||{};var l=typeof q,p=1,r;if(l==="undefined"||l==="boolean"){s=l==="boolean"?q:false;q=o;o=this}if(typeof q!=="object"&&Object.prototype.toString.call(q)!=="[object Function]"){q={}}while(p<=2){r=p===1?o:q;if(r!=null){for(var n in r){var k=o[n],m=r[n];if(o===m){continue}if(s&&m&&typeof m==="object"&&!m.nodeType){o[n]=this.extend(k||(m.length!=null?[]:{}),m,s)}else{if(m!==undefined){o[n]=m}}}}p++}return o};var i=function(k,m){var l=document.createElement("script");m=m||function(){};l.type="text/javascript";l.src=k;document.getElementsByTagName("head")[0].appendChild(l);l.onload=m};function c(l){var k=this;var l=l||{};k.$ele=l.ele;k.wx_json=l.wx_json||{};k.__SHARE_TEXT=l.share_text;k.App=l.App;k.UA=l.UA;k.showtopmenu=l.showtopmenu==null?true:false;k.init()}c.prototype={init:function(){var k=this;k.__SHARE_TEXT.pic=k.__SHARE_TEXT.img;if(!k.__SHARE_TEXT.img||!k.__SHARE_TEXT.url||!k.__SHARE_TEXT.qrcodeurl||!k.__SHARE_TEXT.url_v3){alert("缺少分享参数")}k.emitter=new g();if(k.UA.is_weixin){var m=['<div class="share-fade fn-hide" data-role="share-fade">','    <div class="sharebox" data-role="sharebox"></div>',"</div>"].join("");var l=document.createElement("div");l.innerHTML=m;document.body.appendChild(l);k.wx_event()}else{if(k.UA.is_yue_app||k.UA.is_yue_seller){k.app_event()}else{if(/MQQBrowser\/(\/[\d\.]+)*/i.test(window.navigator.userAgent)){i("http://qzonestyle.gtimg.cn/qzone/qzact/common/share/share.js",function(){k.qq_event()})}else{var m=['<div class="sharebox-rests fn-hide" data-role="sharebox-rests">','            <div class="share-content">','                <span class="yueyue_share_icon sina" data-role="sina"></span>','                <span class="yueyue_share_icon qqzone" data-role="qzone"></span>',"            </div>",'            <div class="share-close" data-role="share-close">取消</div>',"        </div>"].join("");var l=document.createElement("div");l.innerHTML=m;document.body.appendChild(l);k.wap_event()}}}k.includeLinkStyle("//static-c1.yueus.com/yue_ui/share/share.css")},wx_event:function(){var m=this;if(m.UA.is_weixin){var k=document.querySelector('[data-role="share-fade"]');j(k,"click",function(){m.hide_layer()});var p={};var l={};var n=window.location;var o=m.__SHARE_TEXT;p={title:o.title,desc:o.content,link:o.url,imgUrl:o.img+new Date().getTime(),type:"link",dataUrl:"",success:function(q){console.log(q);m.action(q.errMsg)},cancel:function(q){}};l={title:o.title,desc:o.content,link:o.url,imgUrl:o.img+new Date().getTime(),type:"link",dataUrl:"",success:function(q){m.action(q.errMsg)},cancel:function(){}};window.__wx_common_share=p;window.__wx_common_timeline=l;wx.ready(function(){wx.onMenuShareAppMessage(window.__wx_common_share);wx.onMenuShareTimeline(window.__wx_common_timeline);wx.onMenuShareQQ(window.__wx_common_share);wx.onMenuShareQZone(window.__wx_common_share)})}},app_event:function(m){var k=this;if(!m){var l=k.__SHARE_TEXT}if(k.App&&k.App.isPaiApp){window.$_AppCallJSObj=document.body;j(window.$_AppCallJSObj,"onShare",function(n,o){if(o){k.action(o.share_type)}});j(k.$ele,"click",function(){l=a(l,{jscbfunc:"onShare"});k.App.share_card(l,function(n){})});window.__YUEYUE__APP__={};window.__YUEYUE__APP__.SHARE_INFO=l;window.__YUEYUE__APP__.SHARE_INFO.success=function(n){k.action(n.share_type);console.log(n)};k.App.showtopmenu(k.showtopmenu)}},wap_event:function(q){var l=this;var o=document.querySelector('[data-role="sharebox-rests"]');var m=document.querySelector('[data-role="share-close"]');var k=document.querySelector('[data-role="sina"]');var n=document.querySelector('[data-role="qzone"]');if(q){var p=q}else{var p=l.__SHARE_TEXT}l.pic=encodeURI(p.img);l.content=p.content;l.title=p.title;l.url=encodeURI(p.url);j(k,"click",function(){l.action("wap_sina");l.hide_layer();window.open("http://www.yueus.com/action/send_share.php?url="+l.url+"&title="+l.title+"&content="+l.title+"&pic="+l.pic+"&sign=sina")});j(n,"click",function(){l.action("wap_qzone");l.hide_layer();window.open("http://www.yueus.com/action/send_share.php?url="+l.url+"&title="+l.title+"&content="+l.title+"&pic="+l.pic+"&sign=qzone")});j(m,"click",function(){l.hide_layer()})},qq_event:function(m){var k=this;if(m){var l=m}else{var l=k.__SHARE_TEXT}setShareInfo({title:l.title,summary:l.content,pic:l.img+new Date().getTime(),url:window.location.href})},action:function(m){var k=this;var l="";switch(m){case"shareTimeline:ok":l="wx_timeline";break;case"sendAppMessage:ok":l="wx_friend";break;case"shareQQ:ok":l="wx_qq";break;case"shareQZone:ok":l="wx_qzone";break;case"wxsession":l="app_wx_friend";break;case"wxsession":l="app_wx_friend";break;case"wxtimeline":l="app_wx_timeline";break;case"qq":l="app_qq";break;case"qzone":l="app_qzone";break;case"sina":l="app_sina";break;case"wap_sina":l="wap_sina";break;case"wap_qzone":l="wap_qzone";break}k.emitter.trigger("share_success",l)},change_share_text:function(m,o){var k=this;var p=m;if(k.App&&k.App.isPaiApp){j(window.$_AppCallJSObj,"onShare",function(q,r){if(r){k.action(r.share_type)}});if(o){k.App.share_card(p,function(q){})}}else{if(k.UA.is_weixin){var p=m;var n=window.__wx_common_share;var l=window.__wx_common_timeline;n.title=p.title;n.desc=p.content;n.imgUrl=p.img;l.title=p.title;l.desc=p.content;l.imgUrl=p.img;wx.onMenuShareAppMessage(n);wx.onMenuShareTimeline(l);wx.onMenuShareQQ(n);wx.onMenuShareQZone(n)}else{if(k.UA.is_qq){k.qq_event(p)}else{k.wap_event(p)}}}},includeLinkStyle:function(k){var l=document.createElement("link");l.rel="stylesheet";l.type="text/css";l.href=k;document.getElementsByTagName("head")[0].appendChild(l)},show_layer:function(){var l=this;var k=document.querySelector('[data-role="share-fade"]');var m=document.querySelector('[data-role="sharebox-rests"]');if(l.UA.is_weixin){h(k,"fn-hide")}else{h(m,"fn-hide")}},hide_layer:function(){var l=this;var m=document.querySelector('[data-role="sharebox-rests"]');var k=document.querySelector('[data-role="share-fade"]');if(l.UA.is_weixin){b(k,"fn-hide")}else{b(m,"fn-hide")}}};window.yueyue_share_class=c})();