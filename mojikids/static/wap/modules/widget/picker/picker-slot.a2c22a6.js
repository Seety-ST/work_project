define('wap-kids:widget/picker/picker-slot', function(require, exports, module) {

  "use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(exports,"__esModule",{value:!0});var _draggable=require("wap-kids:widget/picker/draggable"),_draggable2=_interopRequireDefault(_draggable),_translate=require("wap-kids:widget/picker/translate"),_translate2=_interopRequireDefault(_translate),_index=require("wap-kids:global/util/index"),_emitter=require("wap-kids:widget/picker/emitter"),_emitter2=_interopRequireDefault(_emitter);!function(t){for(var e=0,a=["webkit","moz"],n=t.requestAnimationFrame,i=t.cancelAnimationFrame,r=a.length;--r>=0&&!n;)n=t[a[r]+"RequestAnimationFrame"],i=t[a[r]+"CancelAnimationFrame"];n&&i||(n=function(t){var a=+new Date,n=Math.max(e+16,a);return setTimeout(function(){t(e=n)},n-a)},i=clearTimeout),t.requestAnimationFrame=n,t.cancelAnimationFrame=i}(window);var rotateElement=function(t,e){if(t){var a=_translate2.default.transformProperty;t.style[a]=t.style[a].replace(/rotateX\(.+?deg\)/gi,"")+(" rotateX("+e+"deg)")}},ITEM_HEIGHT=36,VISIBLE_ITEMS_ANGLE_MAP={3:-45,5:-20,7:-15};exports.default={name:"picker-slot",props:{values:{type:Array,"default":function(){return[]}},value:{},visibleItemCount:{type:Number,"default":5},valueKey:String,rotateEffect:{type:Boolean,"default":!1},divider:{type:Boolean,"default":!1},textAlign:{type:String,"default":"center"},flex:{},className:{},content:{}},data:function(){return{currentValue:this.value,mutatingValues:this.values,dragging:!1,animationFrameId:null}},mixins:[_emitter2.default],computed:{flexStyle:function(){return{flex:this.flex,"-webkit-box-flex":this.flex,"-moz-box-flex":this.flex,"-ms-flex":this.flex}},classNames:function(){var t="picker-slot-",e=[];this.rotateEffect&&e.push(t+"absolute");var a=this.textAlign||"center";return e.push(t+a),this.divider&&e.push(t+"divider"),this.className&&e.push(this.className),e.join(" ")},contentHeight:function(){return ITEM_HEIGHT*this.visibleItemCount},valueIndex:function(){return this.mutatingValues.indexOf(this.currentValue)},dragRange:function(){var t=this.mutatingValues,e=this.visibleItemCount;return[-ITEM_HEIGHT*(t.length-Math.ceil(e/2)),ITEM_HEIGHT*Math.floor(e/2)]}},methods:{value2Translate:function(t){var e=this.mutatingValues,a=e.indexOf(t),n=Math.floor(this.visibleItemCount/2);return-1!==a?(a-n)*-ITEM_HEIGHT:void 0},translate2Value:function(t){t=Math.round(t/ITEM_HEIGHT)*ITEM_HEIGHT;var e=-(t-Math.floor(this.visibleItemCount/2)*ITEM_HEIGHT)/ITEM_HEIGHT;return this.mutatingValues[e]},updateRotate:function(t,e){if(!this.divider){var a=this.dragRange,n=this.$refs.wrapper;e||(e=n.querySelectorAll(".picker-item")),void 0===t&&(t=_translate2.default.getElementTranslate(n).top);var i=Math.ceil(this.visibleItemCount/2),r=VISIBLE_ITEMS_ANGLE_MAP[this.visibleItemCount]||-20;[].forEach.call(e,function(e,n){var l=n*ITEM_HEIGHT,s=a[1]-t,u=l-s,o=u/ITEM_HEIGHT,d=r*o;d>180&&(d=180),-180>d&&(d=-180),rotateElement(e,d),Math.abs(o)>i?_index.addClass(e,"picker-item-far"):_index.removeClass(e,"picker-item-far")})}},planUpdateRotate:function(){var t=this,e=this.$refs.wrapper;cancelAnimationFrame(this.animationFrameId),this.animationFrameId=requestAnimationFrame(function(){t.updateRotate()}),_index.once(e,_translate2.default.transitionEndProperty,function(){t.animationFrameId=null,cancelAnimationFrame(t.animationFrameId)})},initEvents:function(){var t,e,a,n=this,i=this.$refs.wrapper,r={};_draggable2.default(i,{start:function(t){cancelAnimationFrame(n.animationFrameId),n.animationFrameId=null,r={range:n.dragRange,start:new Date,startLeft:t.pageX,startTop:t.pageY,startTranslateTop:_translate2.default.getElementTranslate(i).top},a=i.querySelectorAll(".picker-item")},drag:function(l){n.dragging=!0,r.left=l.pageX,r.top=l.pageY;var s=r.top-r.startTop,u=r.startTranslateTop+s;_translate2.default.translateElement(i,null,u),t=u-e||u,e=u,n.rotateEffect&&n.updateRotate(e,a)},end:function(){n.dragging=!1;var e,a=7,l=_translate2.default.getElementTranslate(i).top,s=new Date-r.start;300>s&&(e=l+t*a);var u=r.range;n.$nextTick(function(){var t;t=e?Math.round(e/ITEM_HEIGHT)*ITEM_HEIGHT:Math.round(l/ITEM_HEIGHT)*ITEM_HEIGHT,t=Math.max(Math.min(t,u[1]),u[0]),_translate2.default.translateElement(i,null,t),n.currentValue=n.translate2Value(t),n.rotateEffect&&n.planUpdateRotate()}),r={}}})},doOnValueChange:function(){var t=this.currentValue,e=this.$refs.wrapper;_translate2.default.translateElement(e,null,this.value2Translate(t))},doOnValuesChange:function(){var t=this.$el,e=t.querySelectorAll(".picker-item");[].forEach.call(e,function(t,e){_translate2.default.translateElement(t,null,ITEM_HEIGHT*e)}),this.rotateEffect&&this.planUpdateRotate()}},mounted:function(){this.ready=!0,this.$emit("input",this.currentValue),this.divider||(this.initEvents(),this.doOnValueChange()),this.rotateEffect&&this.doOnValuesChange()},watch:{values:function(t){this.mutatingValues=t},mutatingValues:function(t){var e=this;-1===this.valueIndex&&(this.currentValue=(t||[])[0]),this.rotateEffect&&this.$nextTick(function(){e.doOnValuesChange()})},currentValue:function(t){this.doOnValueChange(),this.rotateEffect&&this.planUpdateRotate(),this.$emit("input",t),this.dispatch("picker","slotValueChange",this)}}},function(t){module&&module.exports&&(module.exports.template=t),exports&&exports.default&&(exports.default.template=t)}('<div class="picker-slot" :class="classNames" :style="flexStyle">\n  <div v-if="!divider" ref="wrapper" class="picker-slot-wrapper" :class="{ dragging: dragging }" :style="{ height: contentHeight + \'px\' }">\n    <div class="picker-item" v-for="itemValue in mutatingValues" :class="{ \'picker-selected\': itemValue === currentValue }">\n      {{ typeof itemValue === \'object\' &amp;&amp; itemValue[valueKey] ? itemValue[valueKey] : itemValue }}\n    </div>\n  </div>\n  <div v-if="divider">{{ content }}</div>\n</div>');

});
